% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/glm_extension_adam.R
\name{run_spot_glm_windows}
\alias{run_spot_glm_windows}
\title{Parallelized Spot-GLM Model Fitting (Windows)}
\usage{
run_spot_glm_windows(
  Y,
  X,
  lambda,
  family = "spot gaussian",
  beta_0 = NULL,
  fix_coef = NULL,
  offset = NULL,
  initialization = "full",
  G = 0.1,
  num_cores = 1,
  min_deconv = 0.1,
  min_freq = 50,
  CT = NULL,
  weights = NULL,
  ct_cov_weights = NULL,
  n_epochs = 100,
  batch_size = 500,
  learning_rate = 1,
  max_diff = 1 - 1e-06,
  improvement_threshold = 1e-06,
  max_conv = 10,
  intercept_col = NULL
)
}
\arguments{
\item{Y}{Response matrix (spots × responses).}

\item{X}{Covariate matrix (spots × covariates).}

\item{lambda}{Deconvolution matrix (spots × cell types).}

\item{family}{The GLM family to use. One of: \code{"spot gaussian"}, \code{"spot poisson"},
\code{"spot negative binomial"}, or \code{"spot binomial"}.}

\item{beta_0}{Optional initial coefficient matrix (covariates × cell types).}

\item{fix_coef}{Optional logical matrix indicating which coefficients to fix (same dimensions as \code{beta_0}).}

\item{offset}{Optional numeric vector (length equal to number of spots).}

\item{initialization}{Coefficient initialization method: \code{"intercept"} or \code{"full"}.}

\item{G}{Maximum chunk size (in GB) to control memory usage during parallelization.}

\item{num_cores}{Number of CPU cores to use in parallel.}

\item{min_deconv}{Minimum required deconvolution value per spot.}

\item{min_freq}{Minimum frequency for a covariate to be retained in the model.}

\item{CT}{Optional vector of dominant cell types per spot.}

\item{weights}{Optional observation-level weight matrix (spots × genes).}

\item{ct_cov_weights}{Optional cell-type-specific weight matrix (cell types × genes).}

\item{n_epochs}{Number of training epochs.}

\item{batch_size}{Size of each mini-batch.}

\item{learning_rate}{Initial learning rate.}

\item{max_diff}{Convergence threshold based on likelihood improvement ratio.}

\item{improvement_threshold}{Minimum improvement ratio between epochs.}

\item{max_conv}{Number of low-improvement epochs before stopping.}

\item{intercept_col}{Optional column index in \code{X} representing the intercept.}
}
\value{
A named list of model results (one per gene), each containing:
\describe{
\item{beta_est}{Estimated coefficients.}
\item{stand_err_mat}{Standard error matrix.}
\item{disp}{Dispersion estimate (if applicable).}
\item{likelihood}{Final log-likelihood.}
\item{converged}{Convergence status.}
\item{niter}{Number of epochs run.}
\item{vcov}{Variance-covariance matrix.}
\item{fixed_coef}{Final fixed coefficients matrix.}
}
}
\description{
Fits a Spot-GLM model for multiple response variables (e.g., genes) in parallel using \code{foreach} and
\code{doParallel}. Optimized for Windows systems where \code{mclapply} is not available.
}
\details{
This function splits the gene expression matrix into memory-safe chunks,
then evaluates each chunk in parallel using \code{foreach} and \code{doParallel}.
For Mac/Linux, use \code{\link{run_spot_glm_mac}}.

External dependencies include \code{Matrix}, \code{MASS}, \code{LaplacesDemon}.
}
